<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
<title>MeteoRe ‚Äì M√©t√©o pour La R√©union {le plus pr√©cis √† l'√©tang sal√©}</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0d47a1">
<link rel="apple-touch-icon" href="icon-194.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
/* ===== WATERMARK DISCRET MAIS √âL√âGANT ===== */
body::after {
content: "MeteoRe";
position: fixed;
top: 50%;
left: 50%;
transform: translate(-50%, -50%) rotate(-30deg);
font-size: 110px;
font-weight: 800;
color: rgba(2, 136, 209, 0.02);
pointer-events: none;
z-index: -2;
white-space: nowrap;
font-family: 'Inter', sans-serif;
letter-spacing: -2px;
}
/* ===== EFFETS M√âT√âO CONTEXTUELS ===== */
body.sun-glow { background: linear-gradient(135deg, #e3f2fd, #bbdefb); --text: #006064; }
body.cloudy-dim { background: linear-gradient(135deg, #e0e0e0, #b0bec5); filter: brightness(0.94); --text: #37474f; }
body.rainy-dim { background: linear-gradient(135deg, #b0bec5, #90a4ae); filter: brightness(0.88); --text: #455a64; }
body.stormy-dim { background: linear-gradient(135deg, #607d8b, #455a64); filter: brightness(0.85); --text: #e0e0e0; }
.storm-flash { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; opacity: 0; pointer-events: none; z-index: 2000; }
.weather-animation { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; opacity: 0; display: none; }
#anim-sun { top: -120px; right: -120px; width: 320px; height: 320px; background: radial-gradient(circle, rgba(255,215,0,0.3) 0%, transparent 70%); border-radius: 50%; animation: floatSun 50s infinite linear; filter: blur(6px); opacity: 0.85; }
#anim-cloud { top: 15%; left: -160px; width: 220px; height: 90px; background: radial-gradient(ellipse, rgba(255,255,255,0.45) 0%, transparent 80%); border-radius: 50%; animation: floatCloud 70s infinite ease-in-out; }
@keyframes floatSun { to { transform: translateX(200px) rotate(360deg); } }
@keyframes floatCloud { 0%, 100% { transform: translateX(0); } 50% { transform: translateX(200px); } }
:root {
--bg: linear-gradient(135deg, #f0f9ff, #d0f0ff);
--card-bg: rgba(255, 255, 255, 0.92);
--text: #006064;
--accent: #0288d1;
--shadow: 0 8px 24px rgba(2, 136, 209, 0.12);
--border: rgba(2, 136, 209, 0.15);
}
* {
margin: 0; padding: 0; box-sizing: border-box;
font-family: 'Inter', system-ui, -apple-system, sans-serif;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
}
body {
background: var(--bg); color: var(--text); min-height: 100vh;
padding: 0; overflow-x: hidden;
transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
}
#intro {
position: fixed; top: 0; left: 0; width: 100%; height: 100%;
background: linear-gradient(135deg, #e0f7fa, #b2ebf2);
display: flex; flex-direction: column; justify-content: center; align-items: center;
z-index: 9999; opacity: 1; transition: opacity 0.7s ease-out;
}
#intro.hidden { opacity: 0; pointer-events: none; }
#intro-logo {
width: 120px; height: 120px; border-radius: 24px; margin-bottom: 20px;
box-shadow: 0 10px 30px rgba(0,0,0,0.15); animation: pulse 1.5s ease-in-out;
}
@keyframes pulse {
0% { transform: scale(0.9); opacity: 0; }
70% { transform: scale(1.05); }
100% { transform: scale(1); opacity: 1; }
}
#intro-text {
font-size: 34px; font-weight: 800; color: var(--accent);
letter-spacing: 1.2px; text-shadow: 0 2px 6px rgba(0,0,0,0.08);
}
#vigilance-static {
display: inline-block; background: #4CAF50; color: #000;
font-weight: 700; font-size: 12px; font-family: 'Inter', sans-serif;
letter-spacing: 0.3px; padding: 4px 12px; border-radius: 20px;
margin: 12px 16px; box-shadow: 0 3px 8px rgba(0,0,0,0.1);
z-index: 2000; backdrop-filter: blur(4px);
}
#remarques {
text-align: center; font-size: 13px; font-weight: 600;
color: #d32f2f; margin: 8px 0;
background: rgba(255, 235, 235, 0.9); padding: 6px; border-radius: 8px;
max-width: 600px; margin: 12px auto;
}
.top-bar {
display: flex; justify-content: space-between; align-items: center;
padding: 18px 20px; background: rgba(255, 255, 255, 0.8);
backdrop-filter: blur(14px); -webkit-backdrop-filter: blur(14px);
border-bottom: 1px solid var(--border); z-index: 100;
box-shadow: 0 2px 10px rgba(0,0,0,0.04);
}
.logo-with-version {
display: flex; flex-direction: column; align-items: flex-start;
}
.logo { font-weight: 800; font-size: 23px; color: var(--accent); letter-spacing: -0.5px; }
.version { font-size: 10px; opacity: 0.8; margin-top: -2px; font-weight: 600; }
.youtube-btn {
background: #ff0000; color: white; padding: 7px 16px; border: none;
border-radius: 12px; font-weight: 600; font-size: 13px; cursor: pointer;
box-shadow: 0 4px 10px rgba(255,0,0,0.2); transition: all 0.25s ease;
}
.youtube-btn:hover {
transform: translateY(-2px); box-shadow: 0 6px 14px rgba(255,0,0,0.25);
background: #e00000;
}
.container { max-width: 900px; margin: 0 auto; padding: 0 16px 100px; }
.current-weather {
background: var(--card-bg); backdrop-filter: blur(14px);
-webkit-backdrop-filter: blur(14px); border-radius: 26px;
padding: 32px 24px; text-align: center; margin: 28px 0 32px;
box-shadow: var(--shadow); border: 1px solid var(--border);
transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.current-weather:hover {
transform: translateY(-3px); box-shadow: 0 12px 30px rgba(2, 136, 209, 0.18);
}
.location { font-size: 22px; font-weight: 700; margin-bottom: 10px; color: #004d40; }
.current-temp {
font-size: 84px; font-weight: 200; margin: 10px 0;
background: linear-gradient(90deg, #0288d1, #00bcd4);
-webkit-background-clip: text; -webkit-text-fill-color: transparent;
background-clip: text;
}
.current-condition {
font-size: 22px; font-weight: 700; margin: 12px 0; color: #004d40;
display: flex; align-items: center; justify-content: center; gap: 10px;
}
.current-insight {
font-size: 16px; font-weight: 600; margin-top: 12px; opacity: 0.95;
color: var(--accent); line-height: 1.4;
}
.details-grid {
display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top: 22px;
}
.detail-card {
background: rgba(224, 247, 250, 0.6); border-radius: 18px; padding: 16px; text-align: center;
transition: all 0.25s ease; border: 1px solid rgba(2, 136, 209, 0.1);
}
.detail-card:hover {
transform: translateY(-4px); background: rgba(178, 235, 242, 0.9);
box-shadow: 0 6px 14px rgba(0,0,0,0.08);
}
.detail-value { font-weight: 800; font-size: 19px; color: #006064; margin-bottom: 4px; }
.detail-label { font-size: 13px; opacity: 0.85; font-weight: 500; }
.section-title {
font-size: 21px; font-weight: 700; margin: 32px 0 20px;
color: #004d40; display: flex; justify-content: space-between;
align-items: center; padding: 0 4px;
}
.hourly-cards {
display: flex; gap: 16px; overflow-x: auto; padding: 8px 0 16px;
-ms-overflow-style: auto; scrollbar-width: auto;
}
.hourly-cards::-webkit-scrollbar { display: block; height: 6px; }
.hourly-cards::-webkit-scrollbar-thumb {
background: rgba(2, 136, 209, 0.4); border-radius: 3px;
}
.hour-card {
background: var(--card-bg); border-radius: 20px; padding: 18px 12px;
min-width: 84px; text-align: center; border: 1px solid var(--border);
transition: all 0.25s cubic-bezier(0.23, 1, 0.32, 1);
box-shadow: 0 4px 12px rgba(0,0,0,0.05);
display: flex; flex-direction: column; align-items: center; justify-content: center;
}
.hour-card:hover {
transform: translateY(-6px); box-shadow: 0 8px 22px rgba(0,0,0,0.12); z-index: 10;
}
.hour-card img {
margin: 6px 0; width: 30px; height: 30px;
filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1));
}
.forecast-7j {
display: grid; gap: 18px; margin-bottom: 32px;
}
.day-card {
background: var(--card-bg); border-radius: 22px; padding: 20px;
display: flex; justify-content: space-between; align-items: center;
border: 1px solid var(--border); transition: all 0.25s ease;
box-shadow: 0 4px 12px rgba(0,0,0,0.04);
}
.day-card:hover {
transform: translateX(6px); box-shadow: 0 6px 16px rgba(0,0,0,0.08);
}
.day-card img {
width: 32px; height: 32px; filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1));
}
.cyclone-widget {
background: var(--card-bg); border-radius: 22px; padding: 22px;
margin-bottom: 32px; box-shadow: var(--shadow); border: 1px solid var(--border);
text-align: center;
}
#cyclone-image {
width: 100%; max-width: 600px; border-radius: 16px;
display: block; margin: 0 auto; object-fit: cover;
box-shadow: 0 6px 18px rgba(0,0,0,0.1);
}
.footer {
text-align: center; font-size: 13px; opacity: 0.8;
padding: 20px 0 10px; color: var(--text);
}
.footer img {
width: 22px; height: 22px; opacity: 0.7; margin-top: 8px;
filter: grayscale(1) opacity(0.6);
}
.search-bottom {
position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%);
width: 92%; max-width: 520px; background: rgba(255, 255, 255, 0.92);
border-radius: 18px; padding: 14px 18px;
box-shadow: 0 8px 28px rgba(0, 120, 150, 0.25); border: 1px solid var(--border);
z-index: 900; backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
}
#search-input-bottom {
width: 100%; border: none; font-size: 16px; outline: none;
background: transparent; color: var(--text); text-align: center;
font-weight: 600; cursor: pointer; padding: 4px 0;
}
.suggestions-dropdown {
position: absolute; bottom: 100%; left: 0; width: 100%;
background: white; border: 1px solid var(--border); border-radius: 16px;
max-height: 240px; overflow-y: auto; z-index: 9999;
box-shadow: 0 10px 28px rgba(0,0,0,0.18); display: none;
margin-bottom: 12px; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
}
.suggestion-item {
padding: 14px 20px; cursor: pointer; border-bottom: 1px solid #f0f8ff;
font-weight: 600; transition: all 0.2s ease;
}
.suggestion-item:last-child {
border-bottom: none; border-radius: 0 0 16px 16px;
}
.suggestion-item:hover {
background: #e3f2fd; color: var(--accent); transform: translateX(4px);
}
#source-badge {
text-align: right; font-size: 12px; opacity: 0.7;
margin-bottom: 10px; margin-right: 8px;
}
</style>
</head>
<body>
<div class="storm-flash" id="lightning-flash"></div>
<div class="weather-animation" id="anim-sun"></div>
<div class="weather-animation" id="anim-cloud"></div>
<div id="intro">
<img id="intro-logo" src="https://i.imgur.com/KsA0dbG.jpeg" alt="Logo MeteoRe">
<div id="intro-text">MeteoRe</div>
</div>
<div id="remarques">REMARQUES : MeteoRe est plus pr√©cis et fiable pour L'√©tang Sal√©.</div>
<div class="top-bar">
<div class="logo-with-version">
<div class="logo">MeteoRe</div>
<div class="version">V1.20.9</div>
</div>
<button class="youtube-btn">‚ñ∂Ô∏è Retrouve-moi sur YouTube</button>
</div>
<div class="container">
<div class="current-weather">
<div class="location" id="ville-nom">Chargement...</div>
<div class="current-temp" id="current-temp">--¬∞</div>
<div class="current-condition" id="current-condition">‚Äî</div>
<div class="current-insight" id="current-insight"></div>
<div class="details-grid">
<div class="detail-card">
<div class="detail-value" id="humidity">‚Äî%</div>
<div class="detail-label">Humidit√©</div>
</div>
<div class="detail-card">
<div class="detail-value" id="wind">‚Äî km/h</div>
<div class="detail-label">Vent</div>
</div>
<div class="detail-card">
<div class="detail-value" id="uv">‚Äî</div>
<div class="detail-label">UV</div>
</div>
<div class="detail-card">
<div class="detail-value" id="pressure">‚Äî hPa</div>
<div class="detail-label">Pression</div>
</div>
</div>
</div>
<!-- ‚úÖ Titre demand√© -->
<div class="section-title">
<span>Pr√©vision par heure sur 2 jours</span>
<button id="share-btn" style="background:#0288d1;color:white;border:none;border-radius:8px;padding:6px 12px;font-size:13px;font-weight:600;cursor:pointer;box-shadow:0 2px 6px rgba(2,136,209,0.3);">
üì∏ Partager
</button>
</div>
<!-- ‚úÖ Badge simplifi√© -->
<div id="source-badge">Donn√©e fiable</div>
<div class="hourly-cards" id="hourly"></div>
<!-- ‚úÖ Section 7 jours avec VENDREDI 26, etc. -->
<div class="section-title">Pr√©vision 7 jours</div>
<div class="forecast-7j" id="forecast-7j"></div>
<div class="section-title">Activit√© cyclonique en cours...!!! ‚Äì Mise √† jour √† 18h03 le 26/12/2025</div>
<div class="cyclone-widget">
<img id="cyclone-image"
src=""
alt="Carte cyclonique MeteoRe"
onerror="this.src='https://i.imgur.com/mWO8hAe.png';">
<p style="font-size:13px; opacity:0.85; margin-top:12px;">
Mise √† jour quotidienne par MeteoRe
</p>
</div>
<div class="footer">
¬© 2025 MeteoRe ‚Ä¢ M√©t√©o pr√©cise pour La R√©union
<br>
<img src="https://i.imgur.com/KsA0dbG.jpeg" alt="MeteoRe" style="width:22px; height:22px; opacity:0.7; margin-top:8px;">
</div>
</div>
<div class="search-bottom">
<input type="text" id="search-input-bottom" placeholder="Choisissez une ville..." readonly>
<div id="suggestions-dropdown" class="suggestions-dropdown"></div>
</div>
<script>
// üîß 1. SYST√àME DE CORRECTION MANUELLE (40 MIN PAR D√âFAUT)
let manualOverride = {};
const DEFAULT_DURATION_MIN = 40;
function setManualOverride(key, value, minutes = DEFAULT_DURATION_MIN) {
const now = new Date();
const expiresAt = new Date(now.getTime() + minutes * 60 * 1000);
manualOverride[key] = { value, expiresAt };
localStorage.setItem('manualOverride', JSON.stringify(manualOverride));
const etangSale = villesReunion.find(v => v.nom === "L'√âtang-Sal√©");
if (document.getElementById('ville-nom').textContent === etangSale.nom) {
fetchWeather(etangSale.lat, etangSale.lon, etangSale.nom);
}
}
function loadManualOverrides() {
const saved = localStorage.getItem('manualOverride');
if (saved) {
manualOverride = JSON.parse(saved);
const now = new Date();
for (const key in manualOverride) {
if (new Date(manualOverride[key].expiresAt) < now) {
delete manualOverride[key];
}
}
localStorage.setItem('manualOverride', JSON.stringify(manualOverride));
}
}
function getDisplayedValue(key, apiValue) {
const override = manualOverride[key];
if (override && new Date() < new Date(override.expiresAt)) {
return override.value;
}
return apiValue;
}
function clearAllOverrides() {
manualOverride = {};
localStorage.removeItem('manualOverride');
console.log("üßπ [MeteoRe] Toutes les corrections manuelles supprim√©es.");
}
function flashLightning() {
const flash = document.getElementById('lightning-flash');
flash.style.opacity = '0.3';
setTimeout(() => flash.style.opacity = '0', 100);
setTimeout(() => {
flash.style.opacity = '0.2';
setTimeout(() => flash.style.opacity = '0', 80);
}, 300 + Math.random() * 500);
}
function clearWeatherEffects() {
document.body.className = '';
['anim-sun', 'anim-cloud'].forEach(id => {
document.getElementById(id).style.display = 'none';
});
if (window.lightningInterval) clearInterval(window.lightningInterval);
}
function updateWeatherAnimation(condition) {
clearWeatherEffects();
const c = condition.toLowerCase();
if (c.includes('ensoleill√©') || c.includes('clair') || c.includes('√©claircies') || c.includes('soleil')) {
document.body.classList.add('sun-glow');
document.getElementById('anim-sun').style.display = 'block';
} else if (c.includes('nuageux') || c.includes('couvert') || c.includes('brouillard') || c.includes('voil√©')) {
document.body.classList.add('cloudy-dim');
document.getElementById('anim-cloud').style.display = 'block';
} else if (c.includes('pluie') || c.includes('averses') || c.includes('faibles')) {
document.body.classList.add('rainy-dim');
document.getElementById('anim-cloud').style.display = 'block';
} else if (c.includes('orage') || c.includes('orages') || c.includes('violents') || c.includes('fortes')) {
document.body.classList.add('stormy-dim');
document.getElementById('anim-cloud').style.display = 'block';
window.lightningInterval = setInterval(flashLightning, 2000 + Math.random() * 3000);
}
}
const villesReunion = [
{ nom: "Saint-Denis", lat: -20.883, lon: 55.450 },
{ nom: "Saint-Pierre", lat: -21.333, lon: 55.467 },
{ nom: "L'√âtang-Sal√©", lat: -21.150, lon: 55.433 },
{ nom: "Le Tampon", lat: -21.267, lon: 55.517 },
{ nom: "Saint-Beno√Æt", lat: -21.033, lon: 55.717 },
{ nom: "Saint-Andr√©", lat: -20.933, lon: 55.617 },
{ nom: "Le Port", lat: -20.933, lon: 55.283 },
{ nom: "Saint-Louis", lat: -21.21, lon: 55.4 },
{ nom: "Saint-Joseph", lat: -21.383, lon: 55.6 },
{ nom: "La Possession", lat: -20.9, lon: 55.317 },
{ nom: "Cilaos", lat: -21.15, lon: 55.483 },
{ nom: "Salazie", lat: -21.017, lon: 55.533 },
{ nom: "Petite-√éle", lat: -21.35, lon: 55.533 }
];
// ‚úÖ PR√âVISIONS MANUELLES 48H - L'√âTANG-SAL√â
const previsionsManuelles_EtangSale = {
"00h": { label: "Nuit claire", icon: "https://i.imgur.com/9mtLzHK.png" },
"01h": { label: "Nuit claire", icon: "https://i.imgur.com/9mtLzHK.png" },
"02h": { label: "Nuit claire", icon: "https://i.imgur.com/9mtLzHK.png" },
"03h": { label: "Nuit claire", icon: "https://i.imgur.com/9mtLzHK.png" },
"04h": { label: "Nuit claire", icon: "https://i.imgur.com/9mtLzHK.png" },
"05h": { label: "Nuit claire", icon: "https://i.imgur.com/9mtLzHK.png" },
"06h": { label: "Peu nuageux", icon: "https://i.imgur.com/LrHBg6l.png" },
"07h": { label: "Peu nuageux", icon: "https://i.imgur.com/LrHBg6l.png" },
"08h": { label: "Peu nuageux", icon: "https://i.imgur.com/LrHBg6l.png" },
"09h": { label: "Peu nuageux", icon: "https://i.imgur.com/LrHBg6l.png" },
"10h": { label: "Peu nuageux", icon: "https://i.imgur.com/LrHBg6l.png" },
"11h": { label: "Peu nuageux", icon: "https://i.imgur.com/LrHBg6l.png" },
"12h": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"13h": { label: "Eclaircies", icon: "https://i.imgur.com/9mtLzHK.png" },
"14h": { label: "Averses", icon: "https://i.imgur.com/UTtGtvk.png" },
"15h": { label: "Averses", icon: "https://i.imgur.com/UTtGtvk.png" },
"16h": { label: "Averses", icon: "https://i.imgur.com/UTtGtvk.png" },
"17h": { label: "Tr√®s nuageux", icon: "https://i.imgur.com/8EIg3fq.png" },
"18h": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"19h": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"20h": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"21h": { label: "Averses faibles", icon: "https://i.imgur.com/lBjVqLV.png" },
"22h": { label: "Averses faibles", icon: "https://i.imgur.com/lBjVqLV.png" },
"23h": { label: "Averses faibles", icon: "https://i.imgur.com/lBjVqLV.png" },
"00h_j1": { label: "Couvert", icon: "https://i.imgur.com/9mtLzHK.png" },
"01h_j1": { label: "Couvert", icon: "https://i.imgur.com/9mtLzHK.png" },
"02h_j1": { label: "Averses faibles", icon: "https://i.imgur.com/lBjVqLV.png" },
"03h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"04h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"05h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"06h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"07h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"08h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"09h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"10h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"11h_j1": { label: "Peu nuageux", icon: "https://i.imgur.com/1gHBkKj.png" },
"12h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"13h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"14h_j1": { label: "Tr√®s nuageux", icon: "https://i.imgur.com/8EIg3fq.png" },
"15h_j1": { label: "Averses faibles", icon: "https://i.imgur.com/lBjVqLV.png" },
"16h_j1": { label: "Averses faibles", icon: "https://i.imgur.com/lBjVqLV.png" },
"17h_j1": { label: "Averses faibles", icon: "https://i.imgur.com/lBjVqLV.png" },
"18h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"19h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"20h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"21h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"22h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" },
"23h_j1": { label: "Eclaircies", icon: "https://i.imgur.com/1gHBkKj.png" }
};
const previsions7j_EtangSale = [
{ label: "Averses faibles", icon: "https://i.imgur.com/lBjVqLV.png", min: "22¬∞", max: "31¬∞" },
{ label: "Pluie faible", icon: "https://i.imgur.com/cyxhtHc.png", min: "23¬∞", max: "30¬∞" },
{ label: "Averses faibles", icon: "https://i.imgur.com/lBjVqLV.png", min: "22¬∞", max: "32¬∞" },
{ label: "Orages", icon: "https://i.imgur.com/Qre2CV4.png", min: "21¬∞", max: "29¬∞" },
{ label: "Averses", icon: "https://i.imgur.com/UTtGtvk.png", min: "22¬∞", max: "32¬∞" },
{ label: "Averses", icon: "https://i.imgur.com/UTtGtvk.png", min: "23¬∞", max: "29¬∞" },
{ label: "Averses orageuses", icon: "https://i.imgur.com/GlPii5L.png", min: "22¬∞", max: "29¬∞" }
];
const weatherCodeMap = {
0:  { label: 'Ensoleill√©', icon: 'https://i.imgur.com/9mtLzHK.png' },
1:  { label: '√âclaircies', icon: 'https://i.imgur.com/1gHBkKj.png' },
2:  { label: 'Peu nuageux', icon: 'https://i.imgur.com/LrHBg6l.png' },
3:  { label: 'Tr√®s nuageux', icon: 'https://i.imgur.com/8EIg3fq.png' },
45: { label: 'Brouillard', icon: 'https://i.imgur.com/8EIg3fq.png' },
48: { label: 'Brouillard givrant', icon: 'https://i.imgur.com/8EIg3fq.png' },
53: { label: 'Pluie faible', icon: 'https://i.imgur.com/cyxhtHc.png' },
55: { label: 'Pluie mod√©r√©e', icon: 'https://i.imgur.com/UTtGtvk.png' },
61: { label: 'Pluie faible', icon: 'https://i.imgur.com/cyxhtHc.png' },
63: { label: 'Pluie mod√©r√©e', icon: 'https://i.imgur.com/UTtGtvk.png' },
65: { label: 'Pluie forte', icon: 'https://i.imgur.com/zFt161l.png' },
80: { label: 'Averses faibles', icon: 'https://i.imgur.com/lBjVqLV.png' },
81: { label: 'Averses', icon: 'https://i.imgur.com/UTtGtvk.png' },
82: { label: 'Averses fortes', icon: 'https://i.imgur.com/zFt161l.png' },
95: { label: 'Orages', icon: 'https://i.imgur.com/Qre2CV4.png' },
96: { label: 'Averses orageuses', icon: 'https://i.imgur.com/GlPii5L.png' },
99: { label: 'Orages violents', icon: 'https://i.imgur.com/GlPii5L.png' }
};
const moisNoms = ["jan", "f√©v", "mar", "avr", "mai", "juin", "juil", "ao√ªt", "sept", "oct", "nov", "d√©c"];
const joursSemaine = ["DIMANCHE", "LUNDI", "MARDI", "MERCREDI", "JEUDI", "VENDREDI", "SAMEDI"]; // ‚úÖ MAJUSCULES

function formatDateForHourly(date) {
const jour = date.getDate();
const moisIndex = date.getMonth();
const mois = moisNoms[moisIndex];
return `${jour} ${mois}`;
}
function getWeatherData(code) {
return weatherCodeMap[code] || { label: 'Couvert', icon: 'https://i.imgur.com/QR2QKNA.png' };
}
function generateInsight(condition) {
const c = condition.toLowerCase();
const insight = document.getElementById('current-insight');
if (c.includes('orage') || c.includes('orages') || c.includes('averses orageuses')) {
insight.textContent = "‚ö° √âvitez les zones expos√©es et les randonn√©es en altitude.";
} else if (c.includes('pluie') || c.includes('averses')) {
insight.textContent = "üíß Pr√©voyez un imperm√©able si vous sortez.";
} else if (c.includes('ensoleill√©') || c.includes('clair') || c.includes('√©claircies')) {
insight.textContent = "‚òÄÔ∏è Parfait pour la plage !";
} else if (c.includes('nuageux') || c.includes('couvert') || c.includes('voil√©')) {
insight.textContent = "‚òÅÔ∏è Ambiance calme";
} else {
insight.textContent = "üå¶ Une journ√©e typique √† La R√©union.";
}
}
// ‚úÖ FONCTION 48H ‚Äî INTACTE
function renderHourlyForEtangSale() {
const container = document.getElementById('hourly');
container.innerHTML = '';
const now = new Date();
const maxHours = 48;
for (let i = 0; i < maxHours; i++) {
const future = new Date(now.getTime() + i * 3600000);
const hour = future.getHours();
let key = `${hour.toString().padStart(2, '0')}h`;
if (i >= 24) {
key += '_j1';
}
const data = previsionsManuelles_EtangSale[key] || {
label: "Couvert",
icon: "https://i.imgur.com/QR2QKNA.png"
};
const hourStr = `${hour.toString().padStart(2, '0')}h`;
let dateLabel = "";
if (i === 0) {
dateLabel = formatDateForHourly(future);
} else {
const prevTime = new Date(now.getTime() + (i - 1) * 3600000);
if (future.getDate() !== prevTime.getDate() || future.getMonth() !== prevTime.getMonth()) {
dateLabel = formatDateForHourly(future);
}
}
const card = document.createElement('div');
card.className = 'hour-card';
card.innerHTML = `
<div style="font-size:13px; font-weight:600;">${hourStr}</div>
<img src="${data.icon}" alt="${data.label}" style="width:30px;height:30px;margin:6px 0;">
<div style="font-size:11px; opacity:0.85; margin-top:6px;">${data.label}</div>
${dateLabel ? `<div style="font-size:11px; margin-top:4px; color:#006064; font-weight:600;">${dateLabel}</div>` : ''}
`;
container.appendChild(card);
}
}
// ‚úÖ FONCTION 7 JOURS ‚Äî MAJUSCULES + NUM√âRO
function renderForecast7jForEtangSale() {
const container = document.getElementById('forecast-7j');
container.innerHTML = '';
const now = new Date();
for (let i = 0; i < 7; i++) {
const date = new Date(now.getTime() + i * 24 * 3600000);
const dayName = joursSemaine[date.getDay()]; // ‚úÖ MAJUSCULES
const dayNum = date.getDate();
const label = `${dayName} ${dayNum}`; // Ex: "VENDREDI 26"

const data = previsions7j_EtangSale[i] || { label: "Couvert", icon: "https://i.imgur.com/QR2QKNA.png", min: "‚Äî¬∞", max: "‚Äî¬∞" };
const card = document.createElement('div');
card.className = 'day-card';
card.innerHTML = `
<div style="display:flex;align-items:center;gap:12px;">
<img src="${data.icon}" alt="${data.label}" style="width:32px;height:32px;">
<div style="font-weight:600;">${label}</div>
</div>
<div style="text-align:right;">
<div style="font-weight:800;">${data.min} / ${data.max}</div>
<div style="font-size:12px; opacity:0.85;">${data.label}</div>
</div>
`;
container.appendChild(card);
}
}
async function fetchWeatherForEtangSale(lat, lon, nomVille) {
try {
// ‚úÖ URL CORRIG√âE
const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,wind_speed_10m,weather_code,uv_index,pressure_msl&timezone=Indian/Reunion`;
const res = await fetch(url);
const data = await res.json();
const current = data.current;
const temp = getDisplayedValue('temp', Math.round(current.temperature_2m));
const humidity = getDisplayedValue('humidity', Math.round(current.relative_humidity_2m));
const wind = getDisplayedValue('wind', Math.round(current.wind_speed_10m * 3.6));
const uv = getDisplayedValue('uv', current.uv_index ? current.uv_index.toFixed(1) : "‚Äî");
const pressure = getDisplayedValue('pressure', Math.round(current.pressure_msl));
document.getElementById('ville-nom').textContent = nomVille;
document.getElementById('current-temp').textContent = `${temp}¬∞`;
document.getElementById('humidity').textContent = `${humidity}%`;
document.getElementById('wind').textContent = `${wind} km/h`;
document.getElementById('uv').textContent = uv;
document.getElementById('pressure').textContent = `${pressure} hPa`;
const currentHour = new Date().getHours().toString().padStart(2, '0') + 'h';
const currentData = previsionsManuelles_EtangSale[currentHour] || { label: "Couvert", icon: "https://i.imgur.com/QR2QKNA.png" };
document.getElementById('current-condition').textContent = currentData.label;
generateInsight(currentData.label);
updateWeatherAnimation(currentData.label);
renderHourlyForEtangSale();
renderForecast7jForEtangSale();
// ‚úÖ Badge simplifi√©
document.getElementById('source-badge').textContent = "Donn√©e fiable";
} catch (e) {
console.error("API error:", e);
const etangSale = villesReunion.find(v => v.nom === "L'√âtang-Sal√©");
document.getElementById('ville-nom').textContent = etangSale.nom;
document.getElementById('current-temp').textContent = "25¬∞";
document.getElementById('current-condition').textContent = "√âclaircies";
document.getElementById('humidity').textContent = "78%";
document.getElementById('wind').textContent = "17 km/h";
document.getElementById('uv').textContent = "7";
document.getElementById('pressure').textContent = "1012 hPa";
updateWeatherAnimation("√âclaircies");
renderHourlyForEtangSale();
renderForecast7jForEtangSale();
document.getElementById('source-badge').textContent = "Donn√©e fiable";
}
}
async function fetchWeather(lat, lon, nomVille) {
if (nomVille === "L'√âtang-Sal√©") {
await fetchWeatherForEtangSale(lat, lon, nomVille);
return;
}
try {
// ‚úÖ URL CORRIG√âE
const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,wind_speed_10m,weather_code,uv_index,pressure_msl&hourly=temperature_2m,weather_code&daily=temperature_2m_max,temperature_2m_min,weather_code&forecast_days=8&timezone=Indian/Reunion`;
const res = await fetch(url);
const data = await res.json();
const current = data.current;
let currentW = getWeatherData(current.weather_code);
document.getElementById('ville-nom').textContent = nomVille;
document.getElementById('current-temp').textContent = `${Math.round(current.temperature_2m)}¬∞`;
document.getElementById('current-condition').textContent = currentW.label;
document.getElementById('humidity').textContent = `${Math.round(current.relative_humidity_2m)}%`;
document.getElementById('wind').textContent = `${Math.round(current.wind_speed_10m * 3.6)} km/h`;
document.getElementById('uv').textContent = current.uv_index ? current.uv_index.toFixed(1) : "‚Äî";
document.getElementById('pressure').textContent = current.pressure_msl ? `${Math.round(current.pressure_msl)} hPa` : "‚Äî";
const windSpeedKmh = current.wind_speed_10m * 3.6;
generateInsight(currentW.label);
updateWeatherAnimation(currentW.label);
const container = document.getElementById('hourly');
container.innerHTML = '';
const now = new Date();
let count = 0;
const maxHours = 48;
for (let i = 0; i < data.hourly.time.length && count < maxHours; i++) {
const time = new Date(data.hourly.time[i]);
if (time < now) continue;
const hourStr = time.getHours().toString().padStart(2, '0') + 'h';
const temp = Math.round(data.hourly.temperature_2m[i]);
let weatherData = getWeatherData(data.hourly.weather_code[i]);
const forecastDay = new Date(time.getFullYear(), time.getMonth(), time.getDate());
const diffDays = Math.floor((forecastDay - now) / (24 * 60 * 60 * 1000));
let dateBottom = diffDays > 0 ? formatDateForHourly(time) : '';
const card = document.createElement('div');
card.className = 'hour-card';
card.innerHTML = `
<div style="font-size:13px; font-weight:600;">${hourStr}</div>
<img src="${weatherData.icon}" alt="${weatherData.label}" style="width:30px;height:30px;margin:6px 0;">
<div style="font-weight:800;">${temp}¬∞</div>
<div style="font-size:11px; opacity:0.85; margin-top:6px;">${weatherData.label}</div>
${dateBottom ? `<div style="font-size:11px; margin-top:6px; color:#006064;">${dateBottom}</div>` : ''}
`;
container.appendChild(card);
count++;
}
const dailyContainer = document.getElementById('forecast-7j');
dailyContainer.innerHTML = '';
const nowDate = new Date();
const labelsJours = [];
for (let i = 0; i < 7; i++) {
if (i === 0) labelsJours.push("Aujourd'hui");
else if (i === 1) labelsJours.push("Demain");
else labelsJours.push(["Dimanche", "Lundi", "Mardi", "Mercredi", "Jeudi", "Vendredi", "Samedi"][(nowDate.getDay() + i) % 7]);
}
for (let i = 0; i < 7; i++) {
let min = Math.round(data.daily.temperature_2m_min[i]);
let max = Math.round(data.daily.temperature_2m_max[i]);
let weatherData = getWeatherData(data.daily.weather_code[i]);
const card = document.createElement('div');
card.className = 'day-card';
card.innerHTML = `
<div style="display:flex;align-items:center;gap:12px;">
<img src="${weatherData.icon}" alt="${weatherData.label}" style="width:32px;height:32px;">
<div style="font-weight:600;">${labelsJours[i]}</div>
</div>
<div style="text-align:right;">
<div style="font-weight:800;">${min}¬∞ / ${max}¬∞</div>
<div style="font-size:12px; opacity:0.85;">${weatherData.label}</div>
</div>
`;
dailyContainer.appendChild(card);
}
document.getElementById('source-badge').textContent = "Donn√©e de Open-Meteo";
} catch (e) {
console.error(e);
document.getElementById('ville-nom').textContent = nomVille;
document.getElementById('current-temp').textContent = `--¬∞`;
document.getElementById('current-condition').textContent = `Donn√©es non disponibles`;
document.getElementById('current-insight').textContent = "";
updateWeatherAnimation("Couvert");
}
}
const searchInput = document.getElementById('search-input-bottom');
const suggestionsDropdown = document.getElementById('suggestions-dropdown');
function showSuggestions() {
suggestionsDropdown.innerHTML = '';
suggestionsDropdown.style.display = 'block';
villesReunion.forEach(v => {
const el = document.createElement('div');
el.className = 'suggestion-item';
el.textContent = v.nom;
el.onclick = () => {
searchInput.value = v.nom;
suggestionsDropdown.style.display = 'none';
fetchWeather(v.lat, v.lon, v.nom);
};
suggestionsDropdown.appendChild(el);
});
}
searchInput.addEventListener('click', showSuggestions);
document.addEventListener('click', (e) => {
if (!searchInput.contains(e.target) && !suggestionsDropdown.contains(e.target)) {
suggestionsDropdown.style.display = 'none';
}
});
document.querySelector('.youtube-btn').addEventListener('click', () => {
window.open('https://youtube.com/@meteore974', '_blank');
});
document.getElementById('share-btn').addEventListener('click', async () => {
const element = document.querySelector('.container');
const canvas = await html2canvas(element, {
backgroundColor: null,
scale: 1.5,
useCORS: true
});
const ctx = canvas.getContext('2d');
ctx.globalAlpha = 0.04;
ctx.font = 'bold 90px Inter';
ctx.fillStyle = '#0288d1';
ctx.translate(canvas.width / 2, canvas.height / 2);
ctx.rotate(-Math.PI / 6);
ctx.fillText('MeteoRe', -200, 0);
ctx.setTransform(1, 0, 0, 1, 0, 0);
const link = document.createElement('a');
link.download = `meteoRe-${new Date().toISOString().slice(0,10)}.png`;
link.href = canvas.toDataURL('image/png');
link.click();
});
document.addEventListener('DOMContentLoaded', () => {
loadManualOverrides();
setTimeout(() => {
document.getElementById('intro').classList.add('hidden');
const etangSale = villesReunion.find(v => v.nom === "L'√âtang-Sal√©");
searchInput.value = etangSale.nom;
fetchWeather(etangSale.lat, etangSale.lon, etangSale.nom);
}, 1500);
});
</script>
</body>
</html>
