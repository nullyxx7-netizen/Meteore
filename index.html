<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>M√©t√©o La R√©union ‚Äì Nullyxx</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', system-ui, sans-serif; }

    body {
      color: white;
      min-height: 100vh;
      padding: 0;
      overflow-x: hidden;
      scroll-behavior: smooth;
      transition: background 0.8s ease;
      background: linear-gradient(135deg, #87CEEB, #1E90FF);
    }

    #sky { position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: -2; }
    .rain { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; }
    .raindrop { position: absolute; background: rgba(255,255,255,0.7); width: 2px; height: 15px; border-radius: 0 0 2px 2px; animation: fall linear infinite; }
    @keyframes fall { to { transform: translateY(100vh); } }

    .container {
      position: relative;
      z-index: 2;
      padding: 24px 16px 40px;
      max-width: 100%;
    }

    .search-box {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 14px;
      padding: 16px;
      margin-bottom: 24px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    }
    #search-input {
      width: 100%;
      padding: 12px 16px;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      outline: none;
    }
    #suggestions {
      margin-top: 12px;
      max-height: 200px;
      overflow-y: auto;
    }
    .suggestion {
      padding: 10px 14px;
      cursor: pointer;
      border-radius: 10px;
      margin-bottom: 6px;
      background: #e3f2fd;
      color: #0d47a1;
      font-weight: 600;
    }
    .suggestion:hover { background: #bbdefb; }

    .header { text-align: center; margin-bottom: 24px; }
    .location { font-size: 28px; font-weight: 700; text-shadow: 0 2px 6px rgba(0,0,0,0.3); margin-bottom: 8px; }
    .last-update { font-size: 14px; opacity: 0.9; }

    .main-weather {
      background: rgba(255, 255, 255, 0.92);
      color: #1a237e;
      border-radius: 24px;
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      backdrop-filter: blur(10px);
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 0.8s forwards;
    }
    @keyframes fadeInUp {
      to { opacity: 1; transform: translateY(0); }
    }

    .section-title {
      font-size: 18px;
      font-weight: 700;
      margin: 24px 0 16px;
      color: white;
      text-shadow: 0 1px 3px rgba(0,0,0,0.4);
    }

    .hourly {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      padding: 8px 0;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    .hourly::-webkit-scrollbar { display: none; }

    .hour-card {
      background: rgba(255, 255, 255, 0.85);
      border-radius: 18px;
      padding: 16px 12px;
      min-width: 70px;
      text-align: center;
      backdrop-filter: blur(5px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .hour-card .time { font-size: 13px; font-weight: 600; color: #1a237e; }
    .hour-card .emoji { 
      font-size: 24px; 
      margin: 6px 0; 
      cursor: pointer;
      display: inline-block;
      transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .hour-card .emoji:active { transform: scale(1.4); }
    .hour-card .temp { font-size: 16px; font-weight: 700; color: #1a237e; }

    .forecast-3j {
      display: grid;
      gap: 14px;
    }
    .day-card {
      background: rgba(255, 255, 255, 0.85);
      border-radius: 18px;
      padding: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      backdrop-filter: blur(5px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .day-label { font-weight: 700; color: #1a237e; font-size: 16px; }
    .day-detail { 
      font-size: 16px; 
      font-weight: 600; 
      color: #1a237e;
      cursor: pointer;
      display: inline-block;
      transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .day-detail:active { transform: scale(1.3); }

    #meteo-details {
      background: rgba(13, 71, 161, 0.92);
      border-radius: 24px;
      padding: 28px;
      margin-top: 40px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      backdrop-filter: blur(10px);
      color: white;
    }
    .detail-section { margin-bottom: 32px; padding-bottom: 24px; border-bottom: 1px solid rgba(255,255,255,0.2); }
    .detail-section:last-child { border: none; margin-bottom: 0; padding-bottom: 0; }
    .detail-title { font-size: 22px; font-weight: 700; margin-bottom: 16px; color: #bbdefb; }
    .detail-content { font-size: 15px; line-height: 1.6; color: #e3f2fd; }
    .detail-content p { margin-bottom: 12px; font-size: 15px; }
    .highlight { color: #4fc3f7; font-weight: 600; }

    .footer {
      text-align: center;
      margin-top: 24px;
      font-size: 13px;
      opacity: 0.9;
    }

    @media (max-width: 600px) {
      .current { font-size: 60px; }
      .location { font-size: 24px; }
      #meteo-details { padding: 20px; }
    }
  </style>
</head>
<body>

  <div id="sky"></div>
  <div class="rain" id="rain"></div>

  <div class="container">
    <div class="search-box">
      <input type="text" id="search-input" placeholder="Rechercher une ville √† La R√©union...">
      <div id="suggestions"></div>
    </div>

    <div class="header">
      <div class="location" id="ville-nom">S√©lectionnez une ville</div>
      <div class="last-update" id="last-update">Aucune donn√©e</div>
    </div>

    <div class="main-weather" id="main-weather" style="display:none;">
      <div class="current" id="current-temp">--¬∞</div>
      <div class="condition" id="current-condition">--</div>
    </div>

    <div class="section-title">Pr√©vision dans les prochaines heures</div>
    <div class="hourly" id="hourly"></div>

    <div class="section-title">Pr√©vision 3 jours</div>
    <div class="forecast-3j" id="forecast-3j"></div>

    <!-- üìö SECTION √âDUCATIVE (inchang√©e) -->
    <div id="meteo-details">
      <h2 class="detail-title">üìñ Comprendre la m√©t√©o √† La R√©union</h2>
      <div class="detail-section">
        <h3 class="detail-title">üå©Ô∏è Comment se forment les orages ?</h3>
        <div class="detail-content">
          <p>Un orage se forme quand <span class="highlight">l'air chaud et humide</span> monte rapidement dans l'atmosph√®re. √Ä La R√©union, cela arrive souvent :</p>
          <p>‚Ä¢ L'apr√®s-midi, le soleil chauffe les pentes ‚Üí l'air monte le long des reliefs<br>
          ‚Ä¢ En bord de mer, l'humidit√© marine rencontre l'air chaud<br>
          ‚Ä¢ Quand l'air atteint les hauteurs, il se refroidit ‚Üí condensation ‚Üí nuages d'orage (cumulonimbus)</p>
          <p>‚ö° <span class="highlight">√âclairs et tonnerre</span> : caus√©s par des d√©charges √©lectriques entre les charges positives et n√©gatives dans le nuage.</p>
        </div>
      </div>
      <!-- ... reste inchang√© ... -->
      <div class="detail-section">
        <h3 class="detail-title">üåä Anticyclone et vents dominants</h3>
        <div class="detail-content">
          <p>L'<span class="highlight">anticyclone des Mascareignes</span> est un syst√®me de haute pression permanent dans l'oc√©an Indien sud :</p>
          <p>‚Ä¢ Il g√©n√®re les <span class="highlight">aliz√©s</span> (vents d'est) qui soufflent toute l'ann√©e √† La R√©union<br>
          ‚Ä¢ Ces vents apportent humidit√© sur la c√¥te est et s'ass√®chent en traversant l'√Æle<br>
          ‚Ä¢ L'anticyclone "prot√®ge" aussi La R√©union en d√©viant certains cyclones vers le sud</p>
          <p>üå¨Ô∏è Quand l'anticyclone s'affaiblit (√©t√© austral), les cyclones ont plus de chances d'approcher l'√Æle.</p>
        </div>
      </div>
    </div>

    <div class="footer">¬© Nullyxx</div>
  </div>

  <script>
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }

    function init() {
      const villesReunion = [
        { nom: "Saint-Denis", lat: -20.883, lon: 55.450 },
        { nom: "Saint-Pierre", lat: -21.333, lon: 55.467 },
        { nom: "L'√âtang-Sal√©", lat: -21.150, lon: 55.433 },
        { nom: "Le Tampon", lat: -21.267, lon: 55.517 },
        { nom: "Saint-Beno√Æt", lat: -21.033, lon: 55.717 },
        { nom: "Saint-Andr√©", lat: -20.933, lon: 55.617 },
        { nom: "Le Port", lat: -20.933, lon: 55.283 },
        { nom: "Saint-Louis", lat: -21.21, lon: 55.4 },
        { nom: "Saint-Joseph", lat: -21.383, lon: 55.6 },
        { nom: "La Possession", lat: -20.9, lon: 55.317 },
        { nom: "Cilaos", lat: -21.15, lon: 55.483 },
        { nom: "Salazie", lat: -21.017, lon: 55.533 },
        { nom: "Petite-√éle", lat: -21.35, lon: 55.533 }
      ];

      function getCondition(code) {
        if (code === 0) return "Ciel d√©gag√©";
        if (code === 1) return "Ciel peu nuageux";
        if (code === 2) return "Ciel partiellement nuageux";
        if (code === 3) return "Ciel couvert";
        if ([45, 48].includes(code)) return "Brouillard";
        if ([51, 53, 55].includes(code)) return "Bruine";
        if ([61].includes(code)) return "Pluie faible";
        if ([63].includes(code)) return "Pluie mod√©r√©e";
        if ([65].includes(code)) return "Pluie forte";
        if ([80].includes(code)) return "Averses faibles";
        if ([81].includes(code)) return "Averses mod√©r√©es";
        if ([82].includes(code)) return "Averses fortes";
        if ([95].includes(code)) return "Orages";
        if ([96, 99].includes(code)) return "Orages violents";
        return "Ciel variable";
      }

      function getEmoji(code) {
        if (code === 0) return "‚òÄÔ∏è";
        if (code === 1) return "üå§Ô∏è";
        if (code === 2) return "‚õÖ";
        if (code === 3) return "‚òÅÔ∏è";
        if ([45, 48].includes(code)) return "üå´Ô∏è";
        if ([51, 53, 55, 61, 80].includes(code)) return "üå¶Ô∏è";
        if ([63, 65, 81, 82].includes(code)) return "üåßÔ∏è";
        if ([95, 96, 99].includes(code)) return "‚õàÔ∏è";
        return "‚òÅÔ∏è";
      }

      function isRaining(code) {
        return [51,53,55,61,63,65,80,81,82,95,96,99].includes(code);
      }

      function updateSky(code) {
        const sky = document.getElementById('sky');
        if (code === 0 || code === 1) {
          sky.style.background = 'linear-gradient(135deg, #87CEEB, #1E90FF)';
        } else if (code === 2 || code === 3) {
          sky.style.background = 'linear-gradient(160deg, #607d8b, #455a64)';
        } else if (isRaining(code)) {
          sky.style.background = 'linear-gradient(160deg, #2c3e50, #1a1a2e)';
        }
      }

      function createRain() {
        const rain = document.getElementById('rain');
        rain.innerHTML = '';
        for (let i = 0; i < 80; i++) {
          const drop = document.createElement('div');
          drop.className = 'raindrop';
          drop.style.left = Math.random() * 100 + 'vw';
          drop.style.animationDuration = (0.4 + Math.random() * 0.6) + 's';
          rain.appendChild(drop);
        }
      }

      // ==================================================
      // ‚úÖ MODIFIE ICI ‚Üí PR√âVISION HORAIRE POUR L'√âTANG-SAL√â
      // ==================================================
      const heuresManuelles = [
        { hour: "06h", emoji: "üå•Ô∏è", temp: "24¬∞" },
        { hour: "08h", emoji: "üå•Ô∏è", temp: "25¬∞" },
        { hour: "10h", emoji: "üå•Ô∏è", temp: "25¬∞" }, // Tr√®s nuageux
        { hour: "12h", emoji: "üå•Ô∏è", temp: "26¬∞" }, // Tr√®s nuageux
        { hour: "14h", emoji: "üå§Ô∏è", temp: "27¬∞" },
        { hour: "16h", emoji: "üå§Ô∏è", temp: "26¬∞" },
        { hour: "18h", emoji: "üå§Ô∏è", temp: "25¬∞" },
        { hour: "20h", emoji: "üå§Ô∏è", temp: "24¬∞" },
        { hour: "22h", emoji: "üå¶Ô∏è", temp: "23¬∞" },
        { hour: "00h", emoji: "üå§Ô∏è", temp: "23¬∞" },
        { hour: "02h", emoji: "üå§Ô∏è", temp: "22¬∞" },
        { hour: "04h", emoji: "üå§Ô∏è", temp: "22¬∞" }
      ];

      // ==================================================
      // ‚úÖ MODIFIE ICI ‚Üí PR√âVISION 3 JOURS POUR L'√âTANG-SAL√â
      // ==================================================
      const forecast3jManuel = [
        { day: "Aujourd'hui", detail: "Ciel couvert ‚òÅÔ∏è" },
        { day: "Demain", detail: "Averses üåßÔ∏è" },
        { day: "Apr√®s-demain", detail: "Averses faibles üåßÔ∏è" }
      ];

      // ‚úÖ AFFICHAGE MANUEL POUR L'√âTANG-SAL√â
      function renderEtangSaleManual() {
        // Temp√©rature et condition principales (tu peux aussi les modifier ici si besoin)
        document.getElementById('ville-nom').textContent = "L'√âtang-Sal√©";
        document.getElementById('last-update').textContent = "Donn√©es en temps r√©el";
        document.getElementById('current-temp').textContent = "26¬∞";
        document.getElementById('current-condition').textContent = "Ciel couvert";

        updateSky(3); // 3 = Ciel couvert ‚Üí gris
        document.getElementById('rain').innerHTML = '';

        setTimeout(() => {
          document.getElementById('main-weather').style.display = 'block';
          
          // Afficher les heures manuelles
          const container = document.getElementById('hourly');
          container.innerHTML = '';
          heuresManuelles.forEach(item => {
            const card = document.createElement('div');
            card.className = 'hour-card';
            card.innerHTML = `<div class="time">${item.hour}</div><div class="emoji">${item.emoji}</div><div class="temp">${item.temp}</div>`;
            container.appendChild(card);
          });

          // Afficher les 3 jours manuels
          const container3j = document.getElementById('forecast-3j');
          container3j.innerHTML = '';
          forecast3jManuel.forEach(item => {
            const card = document.createElement('div');
            card.className = 'day-card';
            card.innerHTML = `<div class="day-label">${item.day}</div><div class="day-detail">${item.detail}</div>`;
            container3j.appendChild(card);
          });
        }, 300);
      }

      // üåê API POUR LES AUTRES VILLES
      async function fetchWeather(lat, lon, nomVille) {
        if (nomVille === "L'√âtang-Sal√©") {
          document.getElementById('main-weather').style.display = 'none';
          document.getElementById('hourly').innerHTML = '';
          document.getElementById('forecast-3j').innerHTML = '';
          renderEtangSaleManual();
          return;
        }

        // ... (le reste reste inchang√© - API pour autres villes)
        document.getElementById('main-weather').style.display = 'none';
        document.getElementById('hourly').innerHTML = '';
        document.getElementById('forecast-3j').innerHTML = '';

        try {
          const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,weathercode&hourly=temperature_2m,weathercode&forecast_days=2&timezone=Indian/Reunion`;
          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), 8000);
          const res = await fetch(url, { signal: controller.signal });
          clearTimeout(timeoutId);

          if (!res.ok) throw new Error('API indisponible');
          const data = await res.json();
          if (!data || !data.current) throw new Error('Donn√©es invalides');

          const temp = Math.round(data.current.temperature_2m);
          const code = data.current.weathercode;
          const condition = getCondition(code);

          document.getElementById('ville-nom').textContent = nomVille;
          document.getElementById('last-update').textContent = `Donn√©es en temps r√©el`;
          document.getElementById('current-temp').textContent = `${temp}¬∞`;
          document.getElementById('current-condition').textContent = condition;

          updateSky(code);
          document.getElementById('rain').innerHTML = '';
          if (isRaining(code)) createRain();

          setTimeout(() => {
            document.getElementById('main-weather').style.display = 'block';
            renderHourly(data.hourly, data.hourly.time);
            renderForecast3j();
          }, 300);

        } catch (e) {
          console.error('Erreur:', e);
          document.getElementById('ville-nom').textContent = nomVille;
          document.getElementById('last-update').textContent = `Donn√©es non disponibles`;
          document.getElementById('current-temp').textContent = `--¬∞`;
          document.getElementById('current-condition').textContent = `Ciel d√©gag√©`;
          updateSky(0);
          document.getElementById('rain').innerHTML = '';
          renderHourlyFallback();
          renderForecast3j();
        }
      }

      // ... (fonctions renderHourly, renderHourlyFallback, renderForecast3j, recherche - inchang√©es)

      function renderHourly(hourly, times) {
        const container = document.getElementById('hourly');
        container.innerHTML = '';
        const now = new Date();
        let count = 0;
        for (let i = 0; i < times.length && count < 12; i++) {
          const time = new Date(times[i]);
          if (time < now) continue;
          const hourStr = time.getHours().toString().padStart(2, '0') + 'h';
          const temp = Math.round(hourly.temperature_2m[i]) + '¬∞';
          const emoji = getEmoji(hourly.weathercode[i]);
          const card = document.createElement('div');
          card.className = 'hour-card';
          card.innerHTML = `<div class="time">${hourStr}</div><div class="emoji">${emoji}</div><div class="temp">${temp}</div>`;
          container.appendChild(card);
          count++;
        }
      }

      function renderHourlyFallback() {
        const container = document.getElementById('hourly');
        container.innerHTML = '';
        const heures = ["06h","08h","10h","12h","14h","16h","18h","20h","22h","00h","02h","04h"];
        heures.forEach(h => {
          const card = document.createElement('div');
          card.className = 'hour-card';
          card.innerHTML = `<div class="time">${h}</div><div class="emoji">‚òÅÔ∏è</div><div class="temp">25¬∞</div>`;
          container.appendChild(card);
        });
      }

      function renderForecast3j() {
        const data = [
          { day: "Aujourd'hui", detail: "‚Äî" },
          { day: "Demain", detail: "‚Äî" },
          { day: "Apr√®s-demain", detail: "‚Äî" }
        ];
        const container = document.getElementById('forecast-3j');
        container.innerHTML = '';
        data.forEach(item => {
          const card = document.createElement('div');
          card.className = 'day-card';
          card.innerHTML = `<div class="day-label">${item.day}</div><div class="day-detail">${item.detail}</div>`;
          container.appendChild(card);
        });
      }

      const input = document.getElementById('search-input');
      const suggestions = document.getElementById('suggestions');

      input.addEventListener('focus', () => {
        showAllVilles();
      });

      input.addEventListener('input', () => {
        const term = input.value.toLowerCase().trim();
        if (term === '') {
          showAllVilles();
        } else {
          const matches = villesReunion
            .filter(v => v.nom.toLowerCase().includes(term))
            .slice(0, 8);
          showVilles(matches);
        }
      });

      function showAllVilles() {
        showVilles(villesReunion);
      }

      function showVilles(list) {
        suggestions.innerHTML = '';
        list.forEach(v => {
          const el = document.createElement('div');
          el.className = 'suggestion';
          el.textContent = v.nom;
          el.onclick = () => {
            input.value = v.nom;
            suggestions.innerHTML = '';
            fetchWeather(v.lat, v.lon, v.nom);
            input.blur();
          };
          suggestions.appendChild(el);
        });
      }

      input.focus();
    }
  </script>

</body>
</html>
